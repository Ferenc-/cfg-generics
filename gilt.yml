---
- git: https://github.com/osism/cfg-generics.git
  version: master
  files:
    - src: src/render-manager-ansible-requirements.py
      dst: ./environments/manager/render-manager-ansible-requirements.py
    - src: src/prepare-manager-images.py
      dst: ./environments/manager/prepare-manager-images.py
    - src: gilt.yml
      dst: ./gilt.yml
    - src: environments/manager/images.yml
      dst: environments/manager/images.yml
    - src: environments/manager/run.sh
      dst: environments/manager/run.sh
    - src: environments/manager/ansible.cfg
      dst: environments/manager/ansible.cfg
    - src: environments/manager/playbook-*.yml
      dst: environments/manager/
    - src: environments/manager/requirements.*
      dst: environments/manager/
    - src: environments/manager/Pipfile
      dst: environments/manager/
    - src: inventory/51-ceph
      dest: inventory/51-ceph
    - src: inventory/51-kolla
      dest: inventory/51-kolla
      post_commands:
        - python3 render-manager-ansible-requirements.py
        - python3 prepare-manager-images.py
        - rm render-manager-ansible-requirements.py prepare-manager-images.py
